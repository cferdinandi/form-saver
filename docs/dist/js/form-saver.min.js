/*! form-saver v8.1.0 | (c) 2015 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/form-saver */
!function(e,t){"function"==typeof define&&define.amd?define([],t(e)):"object"==typeof exports?module.exports=t(e):e.formSaver=t(e)}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";var t,o,a={},r="querySelector"in document&&"addEventListener"in e&&"localStorage"in e&&"classList"in document.createElement("_"),n={selectorStatus:"[data-form-status]",selectorSave:"[data-form-save]",selectorDelete:"[data-form-delete]",selectorIgnore:"[data-form-no-save]",deleteClear:!0,saveMessage:"Saved!",deleteMessage:"Deleted!",saveClass:"",deleteClass:"",initClass:"js-form-saver",callbackSave:function(){},callbackDelete:function(){},callbackLoad:function(){}},l=function(e,t,o){if("[object Object]"===Object.prototype.toString.call(e))for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(o,e[a],a,e);else for(var r=0,n=e.length;n>r;r++)t.call(o,e[r],r,e)},s=function(){var e={},t=!1,o=0,a=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],o++);for(var r=function(o){for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t&&"[object Object]"===Object.prototype.toString.call(o[a])?e[a]=s(!0,e[a],o[a]):e[a]=o[a])};a>o;o++){var n=arguments[o];r(n)}return e},c=function(e,t){var o,a,r=t.charAt(0);for("["===r&&(t=t.substr(1,t.length-2),o=t.split("="),o.length>1&&(a=!0,o[1]=o[1].replace(/"/g,"").replace(/'/g,"")));e&&e!==document;e=e.parentNode){if("."===r&&e.classList.contains(t.substr(1)))return e;if("#"===r&&e.id===t.substr(1))return e;if("["===r&&e.hasAttribute(o[0])){if(!a)return e;if(e.getAttribute(o[0])===o[1])return e}if(e.tagName.toLowerCase()===t)return e}return null},i=function(e){return e&&"object"==typeof JSON&&"function"==typeof JSON.parse?JSON.parse(e):{}};a.saveForm=function(e,t,o,a){var r=i(e?e.getAttribute("data-options"):{}),u=s(u||n,o||{},r),d=document.querySelector(t),f="formSaver-"+d.id,m={},v=d.elements,g=d.querySelectorAll(u.selectorStatus),p=function(e){c(e,u.selectorIgnore)||("radio"===e.type.toLowerCase()||"checkbox"===e.type.toLowerCase()?e.checked===!0&&(m[e.name+e.value]="on"):"hidden"!==e.type.toLowerCase()&&"submit"!==e.type.toLowerCase()&&e.value&&""!==e.value&&(m[e.name]=e.value))},S=function(e,t,o){e.innerHTML=""===o?"<div>"+t+"</div>":'<div class="'+o+'">'+t+"</div>"};l(v,function(e){p(e)}),l(g,function(e){S(e,u.saveMessage,u.saveClass)}),localStorage.setItem(f,JSON.stringify(m)),u.callbackSave(e,d)},a.deleteForm=function(e,t,o,a){var r=i(e?e.getAttribute("data-options"):{}),c=s(c||n,o||{},r),u=document.querySelector(t),d="formSaver-"+u.id,f=u.querySelectorAll(c.selectorStatus),m=""===c.deleteClass?"<div>"+c.deleteMessage+"</div>":'<div class="'+c.deleteClass+'">'+c.deleteMessage+"</div>",v=function(){c.deleteClear===!0||"true"===c.deleteClear?(sessionStorage.setItem(d+"-formSaverMessage",m),location.reload(!1)):l(f,function(e){e.innerHTML=m})};localStorage.removeItem(d),v(),c.callbackDelete(e,u)},a.loadForm=function(e,t){var o=s(o||n,t||{}),a="formSaver-"+e.id,r=JSON.parse(localStorage.getItem(a)),c=e.elements,i=e.querySelectorAll(o.selectorStatus),u=function(e){r&&("radio"===e.type.toLowerCase()||"checkbox"===e.type.toLowerCase()?"on"===r[e.name+e.value]&&(e.checked=!0):"hidden"!==e.type.toLowerCase()&&"submit"!==e.type.toLowerCase()&&r[e.name]&&(e.value=r[e.name]))},d=function(e){e.innerHTML=sessionStorage.getItem(a+"-formSaverMessage"),sessionStorage.removeItem(a+"-formSaverMessage")};l(c,function(e){u(e)}),l(i,function(e){d(e)}),o.callbackLoad(e)};var u=function(e){var o=e.target,r=c(o,t.selectorSave),n=c(o,t.selectorDelete);r?(e.preventDefault(),a.saveForm(r,r.getAttribute("data-form-save"),t)):n&&(e.preventDefault(),a.deleteForm(n,n.getAttribute("data-form-delete"),t))};return a.destroy=function(){t&&(document.documentElement.classList.remove(t.initClass),document.removeEventListener("click",u,!1),t=null,o=null)},a.init=function(e){r&&(a.destroy(),t=s(n,e||{}),o=document.forms,document.documentElement.className+=(document.documentElement.className?" ":"")+t.initClass,l(o,function(e){a.loadForm(e,t)}),document.addEventListener("click",u,!1))},a});